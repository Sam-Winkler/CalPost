(()=>{let e="",t="",n="",i="";function s(e){"senate"===e?(document.getElementById("senateTab").classList.add("active"),document.getElementById("assemblyTab").classList.remove("active"),document.getElementById("senateLetter").style.display="block",document.getElementById("assemblyLetter").style.display="none"):(document.getElementById("senateTab").classList.remove("active"),document.getElementById("assemblyTab").classList.add("active"),document.getElementById("senateLetter").style.display="none",document.getElementById("assemblyLetter").style.display="block")}function a(e,t){let n,i=e.replace(/^(Senator|Assemblymember|Assembly Member)\s+/i,"");if(i=i.replace(/\s+\(.*\)$/,""),i.includes(","))n=i.split(",")[0].trim();else{const e=i.split(" ");n=e[e.length-1].trim()}return n=n.toLowerCase().replace(/[^a-z]/g,""),t?`senator.${n}@senate.ca.gov`:`assemblymember.${n}@assembly.ca.gov`}function o(e){let t={90001:{name:"Steven Bradford",district:"35th Senate District"},90210:{name:"Ben Allen",district:"24th Senate District"},90025:{name:"Ben Allen",district:"24th Senate District"},90045:{name:"Lola Smallwood-Cuevas",district:"28th Senate District"},91105:{name:"Anthony Portantino",district:"25th Senate District"},91607:{name:"Caroline Menjivar",district:"20th Senate District"},94102:{name:"Scott Wiener",district:"11th Senate District"},94103:{name:"Scott Wiener",district:"11th Senate District"},94704:{name:"Nancy Skinner",district:"9th Senate District"},94707:{name:"Nancy Skinner",district:"9th Senate District"},94086:{name:"Josh Becker",district:"13th Senate District"},94538:{name:"Aisha Wahab",district:"10th Senate District"},92101:{name:"Toni Atkins",district:"39th Senate District"},92115:{name:"Toni Atkins",district:"39th Senate District"},92126:{name:"Brian Jones",district:"40th Senate District"},95814:{name:"Angelique Ashby",district:"8th Senate District"},95825:{name:"Angelique Ashby",district:"8th Senate District"}}[e];t?(t.name.toLowerCase().includes("senator")||(t.name="Senator "+t.name),t.email=a(t.name,!0)):t={name:"Your State Senator",email:"Please check senate.ca.gov for contact information",district:"California State Senate"};let n={90001:{name:"Reggie Jones-Sawyer",district:"59th Assembly District"},90210:{name:"Rick Chavez Zbur",district:"51st Assembly District"},90025:{name:"Rick Chavez Zbur",district:"51st Assembly District"},90045:{name:"Tina McKinnor",district:"61st Assembly District"},91105:{name:"Chris Holden",district:"41st Assembly District"},91607:{name:"Adrin Nazarian",district:"46th Assembly District"},94102:{name:"Matt Haney",district:"17th Assembly District"},94103:{name:"Matt Haney",district:"17th Assembly District"},94704:{name:"Buffy Wicks",district:"15th Assembly District"},94707:{name:"Buffy Wicks",district:"15th Assembly District"},94086:{name:"Marc Berman",district:"23rd Assembly District"},94538:{name:"Alex Lee",district:"24th Assembly District"},92101:{name:"Chris Ward",district:"78th Assembly District"},92115:{name:"Akilah Weber",district:"79th Assembly District"},92126:{name:"Brian Maienschein",district:"76th Assembly District"},95814:{name:"Kevin McCarty",district:"6th Assembly District"},95825:{name:"Kevin McCarty",district:"6th Assembly District"}}[e];return n?(n.name.toLowerCase().includes("assembly")||(n.name="Assemblymember "+n.name),n.email=a(n.name,!1)):n={name:"Your Assembly Member",email:"Please check assembly.ca.gov for contact information",district:"California State Assembly"},{senator:t,assemblyMember:n}}function l(e,t){navigator.clipboard?navigator.clipboard.writeText(e).then((()=>alert(`${t} copied to clipboard!`))).catch((n=>{console.error("Copy failed:",n),r(e,t)})):r(e,t)}function r(e,t){const n=document.createElement("textarea");n.value=e,n.style.position="fixed",document.body.appendChild(n),n.focus(),n.select();try{const e=document.execCommand("copy")?"successful":"unsuccessful";console.log("Fallback copying "+e),alert(`${t} copied to clipboard!`)}catch(e){console.error("Fallback: Could not copy text: ",e),alert(`Failed to copy. Please select and copy the ${t.toLowerCase()} manually.`)}document.body.removeChild(n)}document.addEventListener("DOMContentLoaded",(function(){console.log("Page loaded, setting up handlers"),document.getElementById("generateBtn").addEventListener("click",(function(){console.log("Generate button clicked"),async function(){console.log("Generating letters..."),document.querySelectorAll(".error").forEach((e=>e.style.display="none")),document.getElementById("loading").style.display="block";const s=document.getElementById("fullName").value.trim(),l=document.getElementById("email").value.trim(),r=document.getElementById("address").value.trim(),c=document.getElementById("city").value.trim(),m=document.getElementById("zipCode").value.trim(),d=document.getElementById("company").value.trim(),y=document.getElementById("occupation")?.value.trim()||"";console.log("Form data collected:",{fullName:s,email:l,zipCode:m});let u=!0;if(s||(document.getElementById("nameError").style.display="block",u=!1),l&&l.includes("@")||(document.getElementById("emailError").style.display="block",u=!1),r||(document.getElementById("addressError").style.display="block",u=!1),c||(document.getElementById("cityError").style.display="block",u=!1),m&&/^\d{5}$/.test(m)||(document.getElementById("zipError").style.display="block",u=!1),!u)return void(document.getElementById("loading").style.display="none");const{senator:g,assemblyMember:f}=await async function(e,t,n,i){try{const n=`${e}, ${t}, CA ${i}`,s="",l=`https://civicinfo.googleapis.com/civicinfo/v2/representatives?address=${encodeURIComponent(n)}&levels=administrativeArea1&key=${s}`;console.log("Fetching legislator data from Google Civic API...");const r=await fetch(l),c=await r.json();let m={name:"Your State Senator",email:"Please check senate.ca.gov for contact information",district:"California State Senate"},d={name:"Your Assembly Member",email:"Please check assembly.ca.gov for contact information",district:"California State Assembly"};return c&&c.offices&&c.officials?(c.offices.forEach((e=>{if(e.levels&&e.levels.includes("administrativeArea1")&&e.officialIndices){const t=e.name.toLowerCase().includes("senate")||e.roles&&e.roles.includes&&e.roles.includes("legislatorUpperBody"),n=e.name.toLowerCase().includes("assembly")||e.roles&&e.roles.includes&&e.roles.includes("legislatorLowerBody");e.officialIndices.forEach((i=>{const s=c.officials[i];if(s){const i={name:s.name,district:e.name,party:s.party||""};t?(i.email=a(i.name,!0),i.name.toLowerCase().includes("senator")||(i.name="Senator "+i.name),m=i):n&&(i.email=a(i.name,!1),i.name.toLowerCase().includes("assembly")||(i.name="Assemblymember "+i.name),d=i)}}))}})),{senator:m,assemblyMember:d}):(console.warn("Invalid or missing data from API:",c),o(i))}catch(e){return console.error("Error finding legislators:",e),alert("There was an error contacting the Google Civic API. Using fallback legislator information."),o(i)}}(r,c,0,m);n=g.email,i=f.email,console.log("Legislator emails:",{senatorEmailAddress:n,assemblyEmailAddress:i});const b=new Date,h=`${b.toLocaleString("default",{month:"long"})} ${b.getDate()}, ${b.getFullYear()}`,p=`\nI am writing to you regarding the upcoming legislation on tax incentives for the film industry in California. As one of the many visual effects professionals working in your district, I strongly urge you to expand these incentives to include the visual effects (VFX) sector.\n\nCalifornia's film tax credit program has been instrumental in maintaining our state's competitive edge in film production. However, the current structure overlooks a critical component of modern filmmaking: visual effects. The VFX industry employs thousands of highly skilled Californians and contributes significantly to our state's economy and cultural output, yet California is the only major VFX hub without a standalone tax incentive. This puts California workers at a major disadvantage.\n\nThere are several compelling reasons to include visual effects in these tax incentives:\n\n1. **Economic Impact**: The VFX industry creates high-paying technical jobs and supports numerous auxiliary businesses. By excluding VFX from tax incentives, California actively incentivizes productions to take this substantial portion of their work out of state.\n\n2. **Global Competition**: Countries like Canada, the United Kingdom, and New Zealand offer generous incentives specifically targeting visual effects work. California-based VFX companies are losing projects to these regions, forcing many talented professionals to relocate or change careers.\n\n3. **Technological Innovation**: California's VFX industry has been at the forefront of technological innovation in filmmaking. Supporting this sector reinforces our state's position as a leader in emerging technologies.\n\nCurrently, the qualification requirements are structured in ways that inherently exclude VFX work, despite its integral role in production. These barriers to access should be removed.\n\nI would be happy to discuss this matter further with you or your staff, perhaps offering insights from my perspective within the industry. \n\nThank you for your consideration of this important issue. Your support for including visual effects in film industry tax incentives would help preserve California's leadership in this vital creative and technical field.\n\nSincerely,\n\n${s}\n${r}\n${c}, CA ${m}\n${l}`,v=`${y?"\n"+y:""}${d?"\n"+d:""}`,E=g.name.toLowerCase().includes("senator")?g.name:"Senator "+g.name;e=`${h}\n\n${E}\n${g.district}\n\nRE: Including Visual Effects in California Film Industry Tax Incentives\n\nDear ${E},\n${p}${v}`;const C=f.name.toLowerCase().includes("assembly")?f.name:"Assemblymember "+f.name;t=`${h}\n\n${C}\n${f.district}\n\nRE: Including Visual Effects in California Film Industry Tax Incentives\n\nDear ${C},\n${p}${v}`,document.getElementById("loading").style.display="none",document.getElementById("letterContent").textContent=e,document.getElementById("legislatorName").textContent=E,document.getElementById("senatorEmail").textContent=n,document.getElementById("assemblyLetterContent").textContent=t,document.getElementById("assemblyMemberName").textContent=C,document.getElementById("assemblyEmail").textContent=i,document.getElementById("resultArea").style.display="block",document.getElementById("resultArea").scrollIntoView({behavior:"smooth"}),console.log("Letters generated successfully")}()})),document.getElementById("copyBtn").addEventListener("click",(function(){console.log("Copy Senate letter button clicked"),l(document.getElementById("letterContent").textContent,"Letter")})),document.getElementById("copyAssemblyBtn").addEventListener("click",(function(){console.log("Copy Assembly letter button clicked"),l(document.getElementById("assemblyLetterContent").textContent,"Letter")})),document.getElementById("copySenatorEmailBtn").addEventListener("click",(function(){console.log("Copy Senator email button clicked"),l(document.getElementById("senatorEmail").textContent,"Email address")})),document.getElementById("copyAssemblyEmailBtn").addEventListener("click",(function(){console.log("Copy Assembly email button clicked"),l(document.getElementById("assemblyEmail").textContent,"Email address")})),document.getElementById("senateTab").addEventListener("click",(function(){s("senate")})),document.getElementById("assemblyTab").addEventListener("click",(function(){s("assembly")}))})),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("aboutBtn"),t=document.getElementById("aboutOverlay"),n=document.querySelector(".close-btn");e&&t&&n&&(e.addEventListener("click",(function(){t.style.display="block"})),n.addEventListener("click",(function(){t.style.display="none"})),t.addEventListener("click",(function(e){e.target===t&&(t.style.display="none")})))}))})();